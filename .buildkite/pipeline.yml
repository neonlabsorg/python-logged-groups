env:
  GGBB: $(buildkite-agent meta-data get "full_test_suite" --job ${NEON_EVM_JOB_ID}  --default "false")
steps:
#  - label: "define if for full test suite"
#    command: buildkite-agent meta-data set "full_test_suite" "true"
#    agents:
#      queue: "testing"

  - label: "Echo meta evm_loader_branch"
    commands:
      - echo evm_loader_branch - $(buildkite-agent meta-data keys --job ${NEON_EVM_JOB_ID})
      - echo BUILDKITE_JOB_ID - ${BUILDKITE_JOB_ID}
      - echo BUILDKITE_TRIGGERED_FROM_BUILD_ID - ${BUILDKITE_TRIGGERED_FROM_BUILD_ID}
      - echo NEON_EVM_JOB_ID - ${NEON_EVM_JOB_ID}
      - buildkite-agent step update "env" "MYENV\:\ \"valuevalue\"" --step "to-substitute-label"
    agents:
      queue: "testing"

  - label: "Check if the full test suite should be processed"
    key: "to-substitute-label"
#    if: |
#        (build.pull_request.base_branch == "develop" && !build.pull_request.draft)
#        || (build.source == "trigger_job" && build.env(""))
    commands:
      - echo processing full test suite MYENV -  ${MYENV}

  - label: "Echo env FULL_TEST_SUITE"
    commands:
      - echo "full_test_suite:" ${FULL_TEST_SUITE} -
      - echo BUILDKITE_JOB_ID - ${BUILDKITE_JOB_ID}
    agents:
      queue: "testing"